{% extends 'admin/base_admin.html' %}
{% load static %}

{% block title %}Admin - Currencies{% endblock %}

{% block content %}
<div class="container-fluid py-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="h3 mb-0 text-white">
            <i class="fas fa-money-bill-wave me-2" style="color: var(--accent); text-shadow: 0 0 10px rgba(var(--accent-rgb), 0.7);"></i>Currency Management
        </h1>
        <button type="button" class="btn btn-accent" data-bs-toggle="modal" data-bs-target="#addCurrencyModal">
            <i class="fas fa-plus me-2"></i> Add Currency
        </button>
    </div>

    <div class="card data-card mb-4">
        <div class="card-header bg-primary-dark text-white py-3">
            <h6 class="m-0 fw-bold"><i class="fas fa-coins me-2" style="color: var(--accent); text-shadow: 0 0 5px rgba(var(--accent-rgb), 0.7);"></i>Currencies</h6>
        </div>
        <div class="card-body">
            <div class="table-responsive">
                <table class="table table-hover table-striped" id="currencyTable" width="100%" cellspacing="0">
                    <thead class="thead-accent">
                        <tr>
                            <th>Code</th>
                            <th>Name</th>
                            <th>Rate</th>
                            <th>Last Updated</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for currency in currencies %}
                        <tr class="data-row">
                            <td>
                                <span class="currency-code">{{ currency.code }}</span>
                            </td>
                            <td>{{ currency.name }}</td>
                            <td>
                                <span class="currency-rate">{{ currency.rate }}</span>
                            </td>
                            <td>
                                <span class="currency-date"><i class="far fa-clock me-1" style="color: var(--accent);"></i>{{ currency.last_updated|date:"F d, Y H:i" }}</span>
                            </td>
                            <td>
                                <button class="btn btn-sm btn-glow-info edit-currency" data-id="{{ currency.id }}" title="Edit Currency">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="btn btn-sm btn-glow-danger delete-currency" data-id="{{ currency.id }}" title="Delete Currency">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </td>
                        </tr>
                        {% empty %}
                        <tr>
                            <td colspan="5" class="text-center py-4">
                                <div class="empty-state">
                                    <i class="fas fa-coins fa-3x mb-3" style="color: var(--accent); text-shadow: 0 0 15px rgba(var(--accent-rgb), 0.7);"></i>
                                    <p>No currencies available</p>
                                    <button class="btn btn-accent mt-3" data-bs-toggle="modal" data-bs-target="#addCurrencyModal">
                                        <i class="fas fa-plus me-2"></i> Add Your First Currency
                                    </button>
                                </div>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<!-- Add Currency Modal -->
<div class="modal fade" id="addCurrencyModal" tabindex="-1" aria-labelledby="addCurrencyModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content sci-fi-modal">
            <div class="modal-header bg-primary-dark text-white">
                <h5 class="modal-title" id="addCurrencyModalLabel">
                    <i class="fas fa-plus-circle me-2" style="color: var(--accent); text-shadow: 0 0 5px rgba(var(--accent-rgb), 0.7);"></i>Add Currency
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="addCurrencyForm">
                    <div class="mb-3">
                        <label for="code" class="form-label">Currency Code</label>
                        <div class="input-group sci-fi-input">
                            <span class="input-group-text"><i class="fas fa-tag"></i></span>
                            <input type="text" class="form-control" id="code" name="code" required>
                        </div>
                        <div class="form-text">E.g., USD, EUR, GBP</div>
                    </div>
                    <div class="mb-3">
                        <label for="name" class="form-label">Currency Name</label>
                        <div class="input-group sci-fi-input">
                            <span class="input-group-text"><i class="fas fa-font"></i></span>
                            <input type="text" class="form-control" id="name" name="name" required>
                        </div>
                        <div class="form-text">E.g., US Dollar, Euro, British Pound</div>
                    </div>
                    <div class="mb-3">
                        <label for="rate" class="form-label">Exchange Rate</label>
                        <div class="input-group sci-fi-input">
                            <span class="input-group-text"><i class="fas fa-exchange-alt"></i></span>
                            <input type="number" step="0.0001" class="form-control" id="rate" name="rate" required>
                        </div>
                        <div class="form-text">Rate relative to USD (1 USD = X)</div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                    <i class="fas fa-times me-1"></i> Cancel
                </button>
                <button type="button" class="btn btn-accent pulse-on-hover" id="saveCurrency">
                    <i class="fas fa-save me-1"></i> Save
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Edit Currency Modal -->
<div class="modal fade" id="editCurrencyModal" tabindex="-1" aria-labelledby="editCurrencyModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content sci-fi-modal">
            <div class="modal-header bg-primary-dark text-white">
                <h5 class="modal-title" id="editCurrencyModalLabel">
                    <i class="fas fa-edit me-2" style="color: var(--accent); text-shadow: 0 0 5px rgba(var(--accent-rgb), 0.7);"></i>Edit Currency
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="editCurrencyForm">
                    <input type="hidden" id="edit_id" name="id">
                    <div class="mb-3">
                        <label for="edit_code" class="form-label">Currency Code</label>
                        <div class="input-group sci-fi-input">
                            <span class="input-group-text"><i class="fas fa-tag"></i></span>
                            <input type="text" class="form-control" id="edit_code" name="code" required>
                        </div>
                        <div class="form-text">E.g., USD, EUR, GBP</div>
                    </div>
                    <div class="mb-3">
                        <label for="edit_name" class="form-label">Currency Name</label>
                        <div class="input-group sci-fi-input">
                            <span class="input-group-text"><i class="fas fa-font"></i></span>
                            <input type="text" class="form-control" id="edit_name" name="name" required>
                        </div>
                        <div class="form-text">E.g., US Dollar, Euro, British Pound</div>
                    </div>
                    <div class="mb-3">
                        <label for="edit_rate" class="form-label">Exchange Rate</label>
                        <div class="input-group sci-fi-input">
                            <span class="input-group-text"><i class="fas fa-exchange-alt"></i></span>
                            <input type="number" step="0.0001" class="form-control" id="edit_rate" name="rate" required>
                        </div>
                        <div class="form-text">Rate relative to USD (1 USD = X)</div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                    <i class="fas fa-times me-1"></i> Cancel
                </button>
                <button type="button" class="btn btn-accent pulse-on-hover" id="updateCurrency">
                    <i class="fas fa-save me-1"></i> Update
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Delete Confirmation Modal -->
<div class="modal fade" id="deleteCurrencyModal" tabindex="-1" aria-labelledby="deleteCurrencyModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content sci-fi-modal">
            <div class="modal-header bg-danger text-white">
                <h5 class="modal-title" id="deleteCurrencyModalLabel">
                    <i class="fas fa-exclamation-triangle me-2" style="text-shadow: 0 0 5px rgba(220, 53, 69, 0.7);"></i>Confirm Delete
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="alert alert-warning">
                    <i class="fas fa-exclamation-circle me-2"></i>
                    <p>Are you sure you want to delete this currency? This action cannot be undone.</p>
                </div>
                <input type="hidden" id="delete_id">
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                    <i class="fas fa-times me-1"></i> Cancel
                </button>
                <button type="button" class="btn btn-glow-danger pulse-on-hover" id="confirmDeleteCurrency">
                    <i class="fas fa-trash me-1"></i> Delete
                </button>
            </div>
        </div>
    </div>
</div>

<style>
    .data-card {
        transition: all 0.3s ease;
        border: 1px solid rgba(120, 109, 60, 0.2);
        overflow: hidden;
        background: rgba(20, 21, 48, 0.7);
        backdrop-filter: blur(10px);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2), 0 0 20px rgba(27, 20, 100, 0.1);
        border-radius: 10px;
    }
    
    .data-card:hover {
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3), 0 0 20px rgba(120, 109, 60, 0.3);
        transform: translateY(-5px);
    }
    
    .card-header {
        position: relative;
        overflow: hidden;
        padding: 1.25rem 1.5rem;
    }
    
    .card-header::after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 2px;
        background: linear-gradient(90deg, transparent, var(--accent), transparent);
    }
    
    .thead-accent {
        background: linear-gradient(135deg, rgba(27, 20, 100, 0.9), rgba(27, 20, 100, 0.7));
        color: var(--light-text);
        border-bottom: 2px solid var(--accent);
    }
    
    .thead-accent th {
        font-weight: 600;
        padding: 1rem;
        text-shadow: 0 0 5px rgba(120, 109, 60, 0.5);
        border-bottom: none;
    }
    
    .data-row {
        transition: all 0.3s ease;
        border-bottom: 1px solid rgba(120, 109, 60, 0.1);
    }
    
    .data-row:hover {
        background-color: rgba(120, 109, 60, 0.1);
        box-shadow: 0 0 15px rgba(120, 109, 60, 0.3);
        transform: translateX(5px);
    }
    
    .currency-code {
        font-weight: 700;
        color: var(--light-text);
        background: linear-gradient(135deg, var(--primary-dark), var(--accent));
        padding: 0.3rem 0.6rem;
        border-radius: 4px;
        font-size: 0.8rem;
        box-shadow: 0 0 10px rgba(120, 109, 60, 0.3);
        text-shadow: 0 0 5px rgba(255, 255, 255, 0.5);
        letter-spacing: 0.5px;
    }
    
    .currency-rate {
        font-weight: 600;
        color: var(--light-text);
        text-shadow: 0 0 5px rgba(120, 109, 60, 0.3);
        position: relative;
        padding: 0.2rem 0.5rem;
        background: rgba(27, 20, 100, 0.2);
        border-radius: 4px;
    }
    
    .currency-date {
        color: var(--light-text);
        font-size: 0.875rem;
        opacity: 0.8;
    }
    
    .btn-accent {
        background: linear-gradient(135deg, var(--accent), rgba(120, 109, 60, 0.8));
        color: white;
        border: none;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2), 0 0 15px rgba(120, 109, 60, 0.2);
        transition: all 0.3s ease;
        text-transform: uppercase;
        font-size: 0.85rem;
        font-weight: 600;
        letter-spacing: 0.5px;
        position: relative;
        overflow: hidden;
    }
    
    .btn-accent::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
        transition: all 0.5s;
    }
    
    .btn-accent:hover::before {
        left: 100%;
    }
    
    .btn-accent:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 15px rgba(0, 0, 0, 0.3), 0 0 20px rgba(120, 109, 60, 0.4);
        color: white;
    }
    
    .btn-glow-info {
        background: linear-gradient(135deg, #0dcaf0, #0d6efd);
        color: white;
        border: none;
        box-shadow: 0 0 10px rgba(13, 202, 240, 0.5);
        transition: all 0.3s ease;
        border-radius: 5px;
        padding: 0.4rem 0.6rem;
    }
    
    .btn-glow-info:hover {
        transform: translateY(-2px);
        box-shadow: 0 0 15px rgba(13, 202, 240, 0.7);
    }
    
    .btn-glow-danger {
        background: linear-gradient(135deg, #dc3545, #fd7e14);
        color: white;
        border: none;
        box-shadow: 0 0 10px rgba(220, 53, 69, 0.5);
        transition: all 0.3s ease;
        border-radius: 5px;
        padding: 0.4rem 0.6rem;
    }
    
    .btn-glow-danger:hover {
        transform: translateY(-2px);
        box-shadow: 0 0 15px rgba(220, 53, 69, 0.7);
    }
    
    .sci-fi-modal {
        background: rgba(15, 15, 30, 0.95);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(120, 109, 60, 0.3);
        box-shadow: 0 0 30px rgba(120, 109, 60, 0.2);
        border-radius: 10px;
        overflow: hidden;
    }
    
    .sci-fi-modal .modal-header {
        border-bottom: 1px solid rgba(120, 109, 60, 0.2);
        padding: 1.25rem 1.5rem;
        position: relative;
    }
    
    .sci-fi-modal .modal-header::after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 1px;
        background: linear-gradient(90deg, transparent, var(--accent), transparent);
    }
    
    .sci-fi-modal .modal-footer {
        border-top: 1px solid rgba(120, 109, 60, 0.2);
        padding: 1.25rem 1.5rem;
        position: relative;
    }
    
    .sci-fi-modal .modal-footer::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 1px;
        background: linear-gradient(90deg, transparent, var(--accent), transparent);
    }
    
    .sci-fi-input .form-control {
        background: rgba(30, 30, 50, 0.8);
        border: 1px solid rgba(120, 109, 60, 0.3);
        color: var(--light-text);
        border-radius: 5px;
        padding: 0.75rem 1rem;
        transition: all 0.3s ease;
    }
    
    .sci-fi-input .input-group-text {
        background: linear-gradient(135deg, var(--primary-dark), rgba(27, 20, 100, 0.7));
        border: 1px solid rgba(120, 109, 60, 0.3);
        color: var(--accent);
        border-radius: 5px 0 0 5px;
        padding: 0.75rem 1rem;
    }
    
    .sci-fi-input .form-control:focus {
        box-shadow: 0 0 0 0.25rem rgba(120, 109, 60, 0.25), 0 0 15px rgba(120, 109, 60, 0.3);
        border-color: var(--accent);
        background: rgba(30, 30, 50, 0.9);
    }
    
    .empty-state {
        padding: 3rem;
        text-align: center;
        color: var(--light-text);
        background: rgba(27, 20, 100, 0.1);
        border-radius: 10px;
        margin: 1rem 0;
        border: 1px dashed rgba(120, 109, 60, 0.3);
    }
    
    .bg-primary-dark {
        background: linear-gradient(135deg, var(--primary-dark), rgba(27, 20, 100, 0.8));
    }
    
    .form-text {
        color: rgba(255, 255, 255, 0.6);
        font-size: 0.75rem;
        margin-top: 0.25rem;
        font-style: italic;
    }
    
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }
    
    .data-card {
        animation: fadeIn 0.5s ease-in-out;
    }
    
    .pulse-on-hover:hover {
        animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
        0% {
            transform: scale(1);
            box-shadow: 0 0 0 0 rgba(120, 109, 60, 0.7);
        }
        70% {
            transform: scale(1.02);
            box-shadow: 0 0 10px 5px rgba(120, 109, 60, 0);
        }
        100% {
            transform: scale(1);
            box-shadow: 0 0 0 0 rgba(120, 109, 60, 0);
        }
    }
    
    /* Responsive adjustments */
    @media (max-width: 768px) {
        .data-row:hover {
            transform: none;
        }
        
        .btn-accent, .btn-glow-info, .btn-glow-danger {
            padding: 0.4rem 0.6rem;
            font-size: 0.8rem;
        }
        
        .currency-code {
            padding: 0.2rem 0.4rem;
            font-size: 0.7rem;
        }
    }
    
    /* Notification styling */
    .sci-fi-notification {
        position: fixed;
        top: 20px;
        right: 20px;
        padding: 15px 20px;
        background: rgba(20, 21, 48, 0.9);
        backdrop-filter: blur(10px);
        border-left: 4px solid var(--accent);
        color: var(--light-text);
        border-radius: 5px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3), 0 0 10px rgba(120, 109, 60, 0.3);
        z-index: 9999;
        transform: translateX(100%);
        opacity: 0;
        transition: all 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55);
        min-width: 300px;
    }
    
    .sci-fi-notification.success {
        border-left-color: #28a745;
    }
    
    .sci-fi-notification.success i {
        color: #28a745;
        text-shadow: 0 0 5px rgba(40, 167, 69, 0.7);
    }
    
    .sci-fi-notification.error {
        border-left-color: #dc3545;
    }
    
    .sci-fi-notification.error i {
        color: #dc3545;
        text-shadow: 0 0 5px rgba(220, 53, 69, 0.7);
    }
    
    /* Shake animation for warning icon */
    @keyframes fa-shake {
        0% { transform: rotate(0deg); }
        25% { transform: rotate(5deg); }
        50% { transform: rotate(0deg); }
        75% { transform: rotate(-5deg); }
        100% { transform: rotate(0deg); }
    }
    
    .fa-shake {
        animation: fa-shake 0.5s ease-in-out infinite;
    }
</style>
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Add fade-in animation to rows
        setTimeout(() => {
            const rows = document.querySelectorAll('.data-row');
            rows.forEach((row, index) => {
                setTimeout(() => {
                    row.style.opacity = '0';
                    row.style.animation = 'fadeIn 0.5s ease-in-out forwards';
                    row.style.animationDelay = `${index * 100}ms`;
                }, 100);
            });
        }, 300);

        // Add hover glow effect to action buttons
        const actionButtons = document.querySelectorAll('.btn-glow-info, .btn-glow-danger');
        actionButtons.forEach(btn => {
            btn.addEventListener('mouseenter', function() {
                this.style.transform = 'translateY(-2px)';
                if (this.classList.contains('btn-glow-info')) {
                    this.style.boxShadow = '0 0 15px rgba(13, 202, 240, 0.7)';
                } else {
                    this.style.boxShadow = '0 0 15px rgba(220, 53, 69, 0.7)';
                }
            });
            
            btn.addEventListener('mouseleave', function() {
                this.style.transform = '';
                if (this.classList.contains('btn-glow-info')) {
                    this.style.boxShadow = '0 0 10px rgba(13, 202, 240, 0.5)';
                } else {
                    this.style.boxShadow = '0 0 10px rgba(220, 53, 69, 0.5)';
                }
            });
        });

        // Save new currency
        document.getElementById('saveCurrency').addEventListener('click', function() {
            const form = document.getElementById('addCurrencyForm');
            const formData = new FormData(form);
            const data = Object.fromEntries(formData.entries());
            
            // Add loading effect to button
            const saveBtn = this;
            saveBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-1"></i> Saving...';
            saveBtn.disabled = true;
            
            // Convert string values to numbers where needed
            data.rate = parseFloat(data.rate);
            
            fetch('/api/currencies/', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': getCookie('csrftoken')
                },
                body: JSON.stringify(data)
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json();
            })
            .then(data => {
                // Show success notification
                showNotification('Currency added successfully!', 'success');
                
                // Reset form and close modal
                form.reset();
                const modal = bootstrap.Modal.getInstance(document.getElementById('addCurrencyModal'));
                modal.hide();
                
                // Reload page to show new currency
                setTimeout(() => {
                    window.location.reload();
                }, 1000);
            })
            .catch(error => {
                console.error('Error:', error);
                showNotification('Error adding currency', 'error');
                
                // Reset button
                saveBtn.innerHTML = '<i class="fas fa-save me-1"></i> Save';
                saveBtn.disabled = false;
            });
        });
        
        // Edit currency
        const editButtons = document.querySelectorAll('.edit-currency');
        editButtons.forEach(button => {
            button.addEventListener('click', function() {
                const id = this.getAttribute('data-id');
                
                // Add loading effect to button
                this.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
                
                fetch(`/api/currencies/${id}/`)
                    .then(response => response.json())
                    .then(data => {
                        document.getElementById('edit_id').value = data.id;
                        document.getElementById('edit_code').value = data.code;
                        document.getElementById('edit_name').value = data.name;
                        document.getElementById('edit_rate').value = data.rate;
                        
                        // Reset button and show modal
                        this.innerHTML = '<i class="fas fa-edit"></i>';
                        const modal = new bootstrap.Modal(document.getElementById('editCurrencyModal'));
                        modal.show();
                        
                        // Add focus effect to first field
                        setTimeout(() => {
                            document.getElementById('edit_code').focus();
                        }, 500);
                    })
                    .catch(error => {
                        console.error('Error:', error);
                        showNotification('Error loading currency data', 'error');
                        this.innerHTML = '<i class="fas fa-edit"></i>';
                    });
            });
        });
        
        // Update currency
        document.getElementById('updateCurrency').addEventListener('click', function() {
            const form = document.getElementById('editCurrencyForm');
            const formData = new FormData(form);
            const data = Object.fromEntries(formData.entries());
            const id = data.id;
            
            // Add loading effect to button
            const updateBtn = this;
            updateBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-1"></i> Updating...';
            updateBtn.disabled = true;
            
            // Convert string values to numbers where needed
            data.rate = parseFloat(data.rate);
            
            fetch(`/api/currencies/${id}/`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': getCookie('csrftoken')
                },
                body: JSON.stringify(data)
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json();
            })
            .then(data => {
                // Show success notification
                showNotification('Currency updated successfully!', 'success');
                
                // Close modal
                const modal = bootstrap.Modal.getInstance(document.getElementById('editCurrencyModal'));
                modal.hide();
                
                // Reload page to show updated currency
                setTimeout(() => {
                    window.location.reload();
                }, 1000);
            })
            .catch(error => {
                console.error('Error:', error);
                showNotification('Error updating currency', 'error');
                
                // Reset button
                updateBtn.innerHTML = '<i class="fas fa-save me-1"></i> Update';
                updateBtn.disabled = false;
            });
        });
        
        // Delete currency
        const deleteButtons = document.querySelectorAll('.delete-currency');
        deleteButtons.forEach(button => {
            button.addEventListener('click', function() {
                const id = this.getAttribute('data-id');
                document.getElementById('delete_id').value = id;
                
                // Show delete confirmation modal with animation
                const modal = new bootstrap.Modal(document.getElementById('deleteCurrencyModal'));
                modal.show();
                
                // Add shake animation to warning icon
                const warningIcon = document.querySelector('#deleteCurrencyModal .fa-exclamation-triangle');
                warningIcon.classList.add('fa-shake');
                setTimeout(() => {
                    warningIcon.classList.remove('fa-shake');
                }, 1000);
            });
        });
        
        // Confirm delete
        document.getElementById('confirmDeleteCurrency').addEventListener('click', function() {
            const id = document.getElementById('delete_id').value;
            
            // Add loading effect to button
            const deleteBtn = this;
            deleteBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-1"></i> Deleting...';
            deleteBtn.disabled = true;
            
            fetch(`/api/currencies/${id}/`, {
                method: 'DELETE',
                headers: {
                    'X-CSRFToken': getCookie('csrftoken')
                }
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                
                // Show success notification
                showNotification('Currency deleted successfully!', 'success');
                
                // Close modal
                const modal = bootstrap.Modal.getInstance(document.getElementById('deleteCurrencyModal'));
                modal.hide();
                
                // Reload page
                setTimeout(() => {
                    window.location.reload();
                }, 1000);
            })
            .catch(error => {
                console.error('Error:', error);
                showNotification('Error deleting currency', 'error');
                
                // Reset button
                deleteBtn.innerHTML = '<i class="fas fa-trash me-1"></i> Delete';
                deleteBtn.disabled = false;
            });
        });
        
        // Function to show notifications
        function showNotification(message, type) {
            // Create notification element
            const notification = document.createElement('div');
            notification.className = `sci-fi-notification ${type}`;
            
            // Set icon based on type
            let icon = 'info-circle';
            if (type === 'success') icon = 'check-circle';
            if (type === 'error') icon = 'exclamation-circle';
            
            notification.innerHTML = `
                <i class="fas fa-${icon} me-2"></i>
                <span>${message}</span>
            `;
            
            // Add to document
            document.body.appendChild(notification);
            
            // Animate in
            setTimeout(() => {
                notification.style.transform = 'translateX(0)';
                notification.style.opacity = '1';
            }, 100);
            
            // Remove after delay
            setTimeout(() => {
                notification.style.transform = 'translateX(100%)';
                notification.style.opacity = '0';
                
                // Remove from DOM after animation
                setTimeout(() => {
                    notification.remove();
                }, 500);
            }, 3000);
        }
    });
    
    // Helper function to get CSRF token from cookies
    function getCookie(name) {
        let cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            const cookies = document.cookie.split(';');
            for (let i = 0; i < cookies.length; i++) {
                const cookie = cookies[i].trim();
                if (cookie.substring(0, name.length + 1) === (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }
</script>
{% endblock %}
