<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' https://cdn.jsdelivr.net https://code.jquery.com https://maps.googleapis.com 'unsafe-inline'; style-src 'self' https://cdn.jsdelivr.net https://cdnjs.cloudflare.com 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' https://cdnjs.cloudflare.com; connect-src 'self' https:; frame-src 'self' https://www.google.com; media-src 'self' blob:; object-src 'none';">
    <meta http-equiv="Strict-Transport-Security" content="max-age=31536000; includeSubDomains; preload">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="X-XSS-Protection" content="1; mode=block">
    <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">
    <title>{% block title %}SudaStock{% endblock %}</title>
    <link rel="icon" type="image/png" href="{% static 'images/favicon.png' %}">
    <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="{% static 'css/global.css' %}">
    <link rel="stylesheet" href="{% static 'css/custom.css' %}">
    <link rel="stylesheet" href="{% static 'css/navbar.css' %}">
    <link rel="stylesheet" href="{% static 'css/footer.css' %}">
    <link rel="stylesheet" href="{% static 'css/cookie-consent.css' %}">
    <link rel="stylesheet" href="{% static 'css/dark-mode.css' %}">
    {% block styles %}{% endblock %}
    <style>
        :root {
            --primary-dark: #1B1464;  /* Dark blue from logo */
            --primary-light: #3a3a9e;
            --accent: #786D3C;  /* Gold accent from logo */
            --accent-light: #a39669;
            --text-dark: #333;
            --text-light: #f8f9fa;
            --gray-light: #f8f9fa;
            --gray-medium: #e9ecef;
            --gray-dark: #6c757d;
            --success: #28a745;
            --danger: #dc3545;
            --warning: #ffc107;
            --info: #17a2b8;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: "Comfortaa", sans-serif;
            font-optical-sizing: auto;
            font-weight: normal;
            font-style: normal;
            color: var(--text-dark);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            overflow-x: hidden;
            width: 100%;
        }
        
        main {
            flex: 1;
        }
        
        /* Global button styles */
        .btn-primary {
            background-color: var(--primary-dark);
            border-color: var(--primary-dark);
            color: var(--text-light);
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover, .btn-primary:focus {
            background-color: var(--accent);
            border-color: var(--accent);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .btn-outline-primary {
            color: var(--primary-dark);
            border-color: var(--primary-dark);
            transition: all 0.3s ease;
        }
        
        .btn-outline-primary:hover, .btn-outline-primary:focus {
            background-color: var(--primary-dark);
            color: var(--text-light);
            transform: translateY(-2px);
        }
        
        /* Form control styles */
        .form-control:focus {
            border-color: var(--accent);
            box-shadow: 0 0 0 0.25rem rgba(120, 109, 60, 0.25);
        }
        
        /* Alert styles */
        .alert-primary {
            background-color: rgba(27, 20, 100, 0.1);
            color: var(--primary-dark);
            border-left: 4px solid var(--primary-dark);
        }
        
        .alert-secondary {
            background-color: rgba(120, 109, 60, 0.1);
            color: var(--accent);
            border-left: 4px solid var(--accent);
        }
        
        /* Styles for locked menu items */
        .nav-link.locked {
            position: relative;
            padding-right: 28px !important;
        }
        
        .nav-link.locked::after {
            content: '\f023';
            font-family: 'Font Awesome 5 Free';
            font-weight: 900;
            position: absolute;
            right: 8px;
            color: var(--accent);
            font-size: 0.85em;
        }
        
        .nav-link.locked:hover::after {
            color: white;
        }
        
        .locked-tooltip {
            position: absolute;
            background-color: var(--primary-dark);
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 12px;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            z-index: 100;
            border: 1px solid var(--accent);
        }
        
        .nav-link.locked:hover .locked-tooltip {
            opacity: 1;
            visibility: visible;
        }
        
        /* User menu styles */
        .user-menu {
            display: flex;
            align-items: center;
            color: white;
            cursor: pointer;
            padding: 8px 15px;
            border-radius: 20px;
            background-color: var(--primary-dark);
            border: 1px solid var(--accent);
            transition: all 0.3s ease;
        }
        
        .user-menu:hover {
            background-color: var(--accent);
        }
        
        .user-avatar {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background-color: var(--accent);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 8px;
        }
        
        .user-name {
            margin-right: 8px;
            max-width: 120px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        /* Navbar transparency */
        .navbar {
            transition: background-color 0.3s ease;
            background-color: transparent;

        /* Authentication styles */
        .auth-form-container {
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
            padding: 2.5rem;
            margin-top: 6rem;
            margin-bottom: 3rem;
            border-top: 4px solid var(--primary-dark);
        }
        
        .auth-header {
            text-align: center;
            margin-bottom: 2rem;
        }
        
        .auth-logo {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
        
        .auth-subtitle {
            color: #666;
            font-size: 1rem;
        }
        
        /* Ensure responsive navbar on all devices */
        @media (max-width: 991.98px) {
            .user-menu {
                margin: 10px 0;
            }
            
            .auth-form-container {
                padding: 1.5rem;
                margin-top: 3rem;
            }
        }
        
        /* Responsive logo */
        .logo {
            width: 100%;
            height: 100%;
            max-width: 150px;
            max-height: 50px;
            object-fit: contain;
        }
        
        /* Responsive adjustments for smaller screens */
        @media (max-width: 576px) {
            .auth-form-container {
                padding: 1.5rem;
                margin-top: 2rem;
                margin-bottom: 2rem;
            }
            
            .auth-logo {
                font-size: 1.75rem;
            }
            
            .auth-subtitle {
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    {% include 'navbar.html' %}
    
    <main>
        {% if messages %}
        <div class="container mt-5 pt-4">
            <div class="messages">
                {% for message in messages %}
                <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                    {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}
        
        {% block content %}{% endblock %}
    </main>
    
    {% include 'footer.html' %}
    
    <!-- Cookie Consent Popup -->
    <div id="cookieConsent" class="cookie-consent">
        <div class="cookie-consent-header">
            <i class="fas fa-cookie-bite"></i>
            <h3 class="cookie-consent-title">Cookie Consent</h3>
        </div>
        <p class="cookie-consent-text">
            We use cookies to enhance your browsing experience, serve personalized ads or content, and analyze our traffic. By clicking "Accept All", you consent to our use of cookies. Visit Cookie Settings for more information or to customize your preferences.
        </p>
        <div class="cookie-consent-buttons">
            <button id="acceptAllCookies" class="btn-cookie-accept">Accept All</button>
            <button id="cookieSettingsBtn" class="btn-cookie-settings">Cookie Settings</button>
        </div>
    </div>
    
    <!-- Cookie Settings Modal -->
    <div id="cookieSettingsModal" class="cookie-settings-modal">
        <div class="cookie-settings-content">
            <div class="cookie-settings-header">
                <h3 class="cookie-settings-title">Cookie Settings</h3>
                <button id="closeSettings" class="cookie-settings-close">&times;</button>
            </div>
            
            <div class="cookie-settings-option">
                <div class="cookie-option-header">
                    <h4 class="cookie-option-title">Necessary Cookies</h4>
                    <label class="cookie-switch">
                        <input type="checkbox" id="necessarySwitch" checked disabled>
                        <span class="cookie-slider"></span>
                    </label>
                </div>
                <p class="cookie-option-description">
                    These cookies are essential for the website to function properly. They cannot be disabled.
                </p>
            </div>
            
            <div class="cookie-settings-option">
                <div class="cookie-option-header">
                    <h4 class="cookie-option-title">Preference Cookies</h4>
                    <label class="cookie-switch">
                        <input type="checkbox" id="preferencesSwitch">
                        <span class="cookie-slider"></span>
                    </label>
                </div>
                <p class="cookie-option-description">
                    These cookies allow the website to remember choices you have made and provide enhanced, personalized features.
                </p>
            </div>
            
            <div class="cookie-settings-option">
                <div class="cookie-option-header">
                    <h4 class="cookie-option-title">Analytics Cookies</h4>
                    <label class="cookie-switch">
                        <input type="checkbox" id="analyticsSwitch">
                        <span class="cookie-slider"></span>
                    </label>
                </div>
                <p class="cookie-option-description">
                    These cookies help us understand how visitors interact with our website, helping us improve our services.
                </p>
            </div>
            
            <div class="cookie-settings-option">
                <div class="cookie-option-header">
                    <h4 class="cookie-option-title">Marketing Cookies</h4>
                    <label class="cookie-switch">
                        <input type="checkbox" id="marketingSwitch">
                        <span class="cookie-slider"></span>
                    </label>
                </div>
                <p class="cookie-option-description">
                    These cookies are used to track visitors across websites to display relevant advertisements.
                </p>
            </div>
            
            <div class="cookie-settings-buttons">
                <button id="savePreferences" class="btn-save-preferences">Save Preferences</button>
                <button class="btn-accept-all">Accept All</button>
            </div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="{% static 'js/navbar.js' %}"></script>
    <script>
        // Navbar scroll effect
        $(window).scroll(function() {
            if ($(this).scrollTop() > 50) {
                $('.navbar').addClass('scrolled');
            } else {
                $('.navbar').removeClass('scrolled');
            }
        });
        
        // Auto-hide alerts after 5 seconds
        $(document).ready(function() {
            setTimeout(function() {
                $('.alert').fadeOut('slow');
            }, 5000);
        });
        
        // Mobile menu toggle
        document.getElementById('mobileMenuToggle').addEventListener('click', function() {
            document.getElementById('navLinks').classList.toggle('active');
            this.classList.toggle('active');
        });

        // Initialize dropdowns
        document.addEventListener('DOMContentLoaded', function() {
            // Products dropdown
            const productsDropdown = document.querySelector('.products-dropdown');
            if (productsDropdown) {
                productsDropdown.addEventListener('click', function(e) {
                    e.stopPropagation();
                    this.classList.toggle('active');
                });
            }
            
            // User menu dropdown - prevent navigation when clicking dropdown icon
            const userMenu = document.querySelector('.user-menu');
            const dropdownIcon = userMenu ? userMenu.querySelector('.fa-chevron-down') : null;
            
            if (dropdownIcon) {
                dropdownIcon.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    const dropdown = this.closest('.products-dropdown');
                    if (dropdown) {
                        dropdown.classList.toggle('active');
                    }
                });
            }

            // Close dropdowns when clicking outside
            document.addEventListener('click', function() {
                const dropdowns = document.querySelectorAll('.products-dropdown');
                dropdowns.forEach(function(dropdown) {
                    dropdown.classList.remove('active');
                });
            });
        });
    </script>
    {% block scripts %}{% endblock %}
    
    <script src="{% static 'js/cookie-consent.js' %}"></script>
    <script src="{% static 'js/dark-mode.js' %}"></script>
    <script>
        // Navbar scroll effect for all pages
        document.addEventListener('DOMContentLoaded', function() {
            const navbar = document.querySelector('.navbar');
            
            // Apply scroll effect on page load if already scrolled
            if (window.scrollY > 50) {
                navbar.classList.add('scrolled');
            }
            
            // Add scroll event listener
            window.addEventListener('scroll', function() {
                if (window.scrollY > 50) {
                    navbar.classList.add('scrolled');
                } else {
                    navbar.classList.remove('scrolled');
                }
            });
        });
    </script>
</body>
</html>
